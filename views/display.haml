%p
- report_yslow = "#{yslow}"
- png_path = File.expand_path(File.dirname(__FILE__)) + "/../public/results/#{name}/#{name}*.png"
- puts "cycles : "
- puts cycles
- puts "count : " 
- puts Dir.glob("#{png_path}").count
- png_nb = Dir.glob("#{png_path}").count
- if "#{png_nb}" == "#{cycles}"
	- Dir.glob("#{png_path}").count.times do |view_cycle|
		- png_path = File.expand_path(File.dirname(__FILE__)) + "/../public/results/#{name}/#{name}#{view_cycle}*.png"
		- png_path = Dir["#{png_path}"]
		- png_path = png_path[0]
		- png_name = File.basename(png_path)
		- har_full_path_blob = File.expand_path(File.dirname(__FILE__)) + "/../public/results/#{name}/#{name}#{view_cycle}*.har"
		- har_full_path = Dir["#{har_full_path_blob}"]
		- har_full_path = har_full_path[0]
		- har_name = File.basename(har_full_path)
		.raw-fluid
			- if "#{report_yslow}" == "yes" 
				.span4{:style => "height: 300px !important; overflow: scroll;"}
					%table.table.table-condensed
						- yslow = %x(yslow -i grade -f plain -r ydefault -d #{har_full_path_blob})
						- logger.info "#{yslow}"
						%h2 
							YSLOW 
						%pre 
							- yslow.inspect.gsub('"',"").split(/\\n/).each do |info|
								#{info}
			.span4{:style => "height: 300px !important; overflow: scroll;"}
				%h2
					SCREENSHOT
				%img{:src => "/results/#{name}/#{png_name}"}
		:javascript
			(function() {
			    var har = document.createElement("script");
			    har.src = "/har.js";
			    har.setAttribute("id", "har");
			    har.setAttribute("async", "true");
			    document.documentElement.firstChild.appendChild(har);
			})();
		.har{:id =>"har#{view_cycle}",:"data-har" => "/results/#{name}/#{har_name}", :validate => "false",:stats => "true",:height => "300"}
	%p
- else
	%script{:type => "text/javascript", :src => "http://fgnass.github.com/spin.js/dist/spin.js"}
	:javascript
		setTimeout(function(){
		   window.location.reload(1);
		}, 5000);
	.span12.offset3
		%p
		%p
			%h2 Testing : = #{www_url}
	.span12{:id => "foo"}
		:javascript
			var opts = {
				lines: 13, // The number of lines to draw
				length: 7, // The length of each line
				width: 4, // The line thickness
				radius: 10, // The radius of the inner circle
				corners: 1, // Corner roundness (0..1)
				rotate: 0, // The rotation offset
				color: '#000', // #rgb or #rrggbb
				speed: 1, // Rounds per second
				trail: 60, // Afterglow percentage
				shadow: false, // Whether to render a shadow
				hwaccel: false, // Whether to use hardware acceleration
				className: 'spinner', // The CSS class to assign to the spinner
				zIndex: 2e9, // The z-index (defaults to 2000000000)
				top: 'auto', // Top position relative to parent in px
				left: 'auto' // Left position relative to parent in px
			};
			var target = document.getElementById('foo');
			var spinner = new Spinner(opts).spin(target); 